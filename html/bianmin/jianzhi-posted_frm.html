<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>信息发布-全职招聘</title>
    <link rel="stylesheet" type="text/css" href="../../css/aui.css" />
    <link rel="stylesheet" type="text/css" href="../../css/common.css" />
    <link rel="stylesheet" type="text/css" href="../../css/fontcss/iconfont.css" />
    <style>
	.aui-list .aui-list-item-label{ width:25%;}
	aui-input, input[type="text"], input[type="password"], input[type="search"], input[type="email"], input[type="tel"], input[type="url"], input[type="date"], input[type="datetime-local"], input[type="time"], input[type="number"], select, textarea{font-size: 0.7rem !important;}
	.aui-list textarea{ height:auto;}
	.aui-radio:checked, .aui-radio.aui-checked, .aui-checkbox:checked, .aui-checkbox.aui-checked{background-color:#f39b0a;border: solid 1px #f39b0a;}
	.aui-radio, .aui-checkbox{margin-top: 0.2rem;width:0.8rem;height:0.8rem; }

	.aui-list-item-label{font-size: 0.7rem !important;}
	.aui-list-item-input{font-size: 0.7rem !important;}
	select{font-size: 0.7rem !important;}

	input[type="number"]{border-radius:4px;height: 1.3rem; margin:5px; text-align: center;}
    </style>
</head>
<body>
<div class="aui-content aui-margin-b-15" id="app" v-cloak="">
    <div class="aui-padded-15">
        <div class="aui-card-list-content" @click="select_cover()">
            <img :src="cover" class="aui-img-round" style="width:4rem;margin:auto;">
        </div>
    </div>
    <ul class="aui-list aui-form-list aui-shadow aui-list-noborder aui-margin-t-10 aui-margin-b-10">
        <li class="aui-list-header aui-bg-orange aui-font-size-14" style=" color:#fff;">基本信息</li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label"> 姓名:</div>
                <div class="aui-list-item-input">
                    <input type="text" placeholder="姓名" v-model="name">
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label">性别:</div>
                <div class="aui-list-item-input">
                    <select v-model="sex">
                        <option value="1">男</option>
                        <option value="2">女</option>
                    </select>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label"> 出生日期:</div>
                <div class="aui-list-item-input">
                    <input type="date" placeholder="出生日期" v-model="birthday">
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label"> 现居住地:</div>
                <div class="aui-list-item-input">
                    <input type="text" placeholder="现居住地" v-model="address">
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label"> 籍贯:</div>
                <div class="aui-list-item-input">
                    <input type="text" placeholder="籍贯" v-model="native_place">
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label">最高学历:</div>
                <div class="aui-list-item-input">
                    <select v-model="education">
                        <option value="0">不限</option>
                        <option value="1">高中</option>
                        <option value="2">大专</option>
                        <option value="3">本科</option>
                        <option value="4">硕士</option>
                        <option value="5">博士</option>
                    </select>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label"> 我的身份:</div>
                <div class="aui-list-item-input">
                    <select v-model="identity">
                        <option value="1">在校学生</option>
                        <option value="2">社会人才</option>
                    </select>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label">实践经验:</div>
                <div class="aui-list-item-input">
                    <select v-model="is_practice">
                        <option value="1">有</option>
                        <option value="2">无</option>
                    </select>
                </div>
            </div>
        </li>               
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label">电子邮箱:</div>
                <div class="aui-list-item-input">
                    <input type="text" placeholder="" v-model="email">
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label">手机号码:</div>
                <div class="aui-list-item-input">
                    <input type="number" placeholder="" v-model="telephone">
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label">空余时间上午：</div>
                <div class="aui-list-item-input">
                    <select v-model="freetime_morning">
                        <option value="1">周一上午</option>
                        <option value="2">周二上午</option>
                        <option value="3">周三上午</option>
                        <option value="4">周四上午</option>
                        <option value="5">周五上午</option>
                        <option value="6">周六上午</option>
                        <option value="7">周日上午</option>
                    </select>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-inner">
                <div class="aui-list-item-label">空余时间下午：</div>
                <div class="aui-list-item-input">
                    <select v-model="freetime_afternoon">
                        <option value="1">周一下午</option>
                        <option value="2">周二下午</option>
                        <option value="3">周三下午</option>
                        <option value="4">周四下午</option>
                        <option value="5">周五下午</option>
                        <option value="6">周六下午</option>
                        <option value="7">周日下午</option>
                    </select>
                </div>
            </div>
        </li>
    </ul>
</div>
</body>
</html>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/vue.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script>
    var vm = new Vue({
        el: '#app',
        data: {
            token: '',
            base_url:base_url,
            cover_url:'',
            cover:'../../image/user_pic.png',
            thumb:'',

            name:'',
            sex:1,
            birthday:'',
            address:'',
            native_place:'',
            education:3,
            identity:1,
            is_practice:1,
            email:'',
            telephone:'',
            freetime_morning:'',
            freetime_afternoon:'',
        },
        methods: {
            init: function () {
                if (!(/^1[3|4|5|7|8]\d{9}$/.test(vm.telephone))) {
                    api.toast({
                        msg: '手机号码有误',
                        duration: 2000,
                        location: 'bottom'
                    });
                    return false;
                }
                api.ajax({
                    url: parttime_add_url,
                    method: 'post',
                    timeout: 30,
                    dataType: 'json',
                    returnAll: false,
                    data: {
                        values: {
                            token: vm.token,
                            name: vm.name,
                            sex: vm.sex,
                            birthday: vm.birthday,
                            address: vm.address,
                            native_place: vm.native_place,
                            education: vm.education,
                            identity: vm.identity,
                            is_practice: vm.is_practice,
                            email: vm.email,
                            telephone: vm.telephone,
                            freetime_morning: vm.freetime_morning,
                            freetime_afternoon: vm.freetime_afternoon,
                            thumb: vm.thumb
                        }
                    }
                }, function (ret, err) {
                    if (ret) {
                        console.log(JSON.stringify(ret));
                        api.toast({
                            msg: ret.msg,
                            duration: 2000,
                            location: 'bottom'
                        });
                        if(ret.status == 1){
                            api.sendEvent({
                                name: 'parttime_list_init',
                            });
                            setTimeout(function () {
                                api.closeWin({
                                    name: 'jianzhi-posted_win'
                                });
                            },1000)
                        }
                    } else {
                        console.log(JSON.stringify(err));
                    }
                });
            },
            select_cover:function () {
                api.getPicture({
                    sourceType: 'library',
                    encodingType: 'jpg',
                    mediaValue: 'pic',
                    destinationType: 'url',
                    allowEdit: true,
                    quality: 50,
                    targetWidth: 100,
                    targetHeight: 100,
                    saveToPhotoAlbum: false
                }, function(ret, err) {
                    if (ret) {
                        console.log(JSON.stringify(ret));
                        if(ret.data){
                            vm.cover = ret.data;
                            vm.file_upload();
                        }
                    } else {
                        alert(JSON.stringify(err));
                    }
                });
            },
            file_upload:function () {
                api.ajax({
                    url: upload_url,
                    method: 'post',
                    timeout: 30,
                    dataType: 'json',
                    returnAll: false,
                    data: {
                        values: {
                            token: vm.token
                        },
                        files: {
                            file: vm.cover
                        }
                    }
                }, function (ret, err) {
                    if (ret) {
                        console.log(JSON.stringify(ret));
                        vm.cover_url = ret.path + '/' + ret.name;
                        vm.thumb = ret.path + '/' + ret.name;
                    } else {
                        console.log(JSON.stringify(err));
                    }
                });
            },
        }
    });

    apiready = function () {
        vm.token = $api.getStorage('token');
        api.addEventListener({
            name: 'parttime_add_init'
        }, function (ret, err) {
            vm.init();
        });
    };
</script>
