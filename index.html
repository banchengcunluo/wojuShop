<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,initial-scale=1.0,width=device-width"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>蜗居乐购APP</title>
    <link rel="stylesheet" type="text/css" href="./css/aui.css" />
    <link rel="stylesheet" type="text/css" href="./css/common.css" />
    <style>
        .aui-bar-nav .aui-iconfont {
            color: #9B9B9B;
            font-size: 0.7rem;
        }
        .disnone{
            display: none;
        }
        .disblock{
            display: block;
        }
        .woju-bar-btn {
            margin-top: 0rem !important;
            margin-bottom: 0rem !important;
        }
        .aui-bar-btn-item{
            border-color: #FFFFFF !important;
            border-color: #FFFFFF !important;
        }
        .woju-active{
            background-color: #f39905 !important;
            border-color: #f39905 !important;
            color: #FFFFFF;
        }
        .woju-normal{
            background-color: #FFFFFF ;
            border-color: #f5f5f5 !important;
        }
        .fenlei-right-border{
            border-right: none !important;
        }
        .brand-left-border{
            border-left: none !important;
        }
    </style>
</head>
<body>
<div id="app">
    <header class="aui-bar aui-bar-nav aui-bar-light aui-font-size-16 aui-border-b disnone"
            v-bind:class="{'disblock': on_index== 0}">
        <a class="aui-pull-left aui-btn">
            <img src="res/nvtabbar/shop-logo.png" style="height: 24px;">
        </a>
        &nbsp;&nbsp;
        <a class="aui-pull-right aui-btn">
            <img src="res/nvtabbar/ico-search.png" class="aui-margin-r-10"
                 style="height: 20px;" onclick="open_window('shop','search_win')">
            <img src="res/nvtabbar/ico-message.png" style="height: 22px;" onclick="open_meiQia()">
        </a>
    </header>
    <header class="aui-bar aui-bar-nav aui-bar-light aui-font-size-16 disnone"
            v-bind:class="{'disblock': on_index== 1}">

        <div class="aui-bar aui-bar-btn woju-bar-btn aui-bar-btn-round"
             style="width:45% !important;min-height: 0rem !important;max-height: 2rem !important;padding:8.5px 0px;">
            <div class="aui-bar-btn-item fenlei-right-border woju-normal"
                 v-bind:class="{'woju-active':isfenlei==1}" tapmode="woju-normal" @click="fenlei_brand(1)">分类</div>
            <div class="aui-bar-btn-item brand-left-border woju-normal"
                 v-bind:class="{'woju-active':isbrand==1}" tapmode="woju-normal" @click="fenlei_brand(0)">品牌</div>
        </div>

    </header>
    <header class="aui-bar aui-bar-nav aui-bar-light aui-font-size-16 aui-border-b disnone"
            v-bind:class="{'disblock': on_index== 2}">购物车</header>
    <header class="aui-bar aui-bar-nav aui-bar-light aui-font-size-16 aui-border-b disnone"
            v-bind:class="{'disblock': on_index== 3}" id="aui-header">便民</header>
    <header class="aui-bar aui-bar-nav aui-bar-light aui-font-size-16 aui-border-b disnone"
            v-bind:class="{'disblock': on_index== 4}">我的</header>
</div>
</body>
</html>
<script src="script/api.js"></script>
<script src="script/vue.js"></script>
<script src="script/common.js"></script>
<script>

    var vm = new Vue({
        el: '#app',
        data: {
            on_index: 0,//显示当前索引
            isfenlei:1,
            isbrand:0,
            list:[
                {title:'首页'},
                {title:' '},
                {title:'购物车'},
                {title:'便民'},
                {title:'我的'}
            ]
        },
        methods: {
            init: function () {
                api.openFrameGroup({
                    name: 'IndexGroup',//app首页frame组预加载
                    background: 'bgcolor',
                    scrollEnabled: false,
                    rect: {
                        x: 0,
                        y: $api.dom('header').offsetHeight,
                        w: api.winWidth,
                        h: api.winHeight - $api.dom('header').offsetHeight - 50
                    },
                    index: vm.on_index,
                    preload:5,
                    frames: [
                        {
                            name: 'index0',
                            url: 'widget://html/index/index.html',
                            bgColor: 'bgcolor',
                            bounces: true
                        },
                        {
                            name: 'index1',
                            url: 'widget://html/shop/index.html',
                            bgColor: 'bgcolor',
                            bounces: false,
                            reload: true
                        },
                        {
                            name: 'index2',
                            url: 'widget://html/cart/index.html',
                            bgColor: 'bgcolor',
                            bounces: true
                        },

                        {
                            name: 'index3',
                            url: 'widget://html/bianmin/index.html',
                            //url: 'http://www.duiba.com.cn/test/demoRedirectSAdfjosfdjdsa',
                            bgColor: 'bgcolor',
                            bounces: true
                        },

                        {
                            name: 'index4',
                            url: 'widget://html/member/index.html',
                            bgColor: 'bgcolor',
                            bounces: true
                        }
                    ]
                }, function (ret, err) {


                });
            },
            fenlei_brand:function (index) {
                if(index == 0){
                    vm.isfenlei = 0;
                    vm.isbrand = 1;
                }else{
                    vm.isfenlei = 1;
                    vm.isbrand = 0;
                }
                api.sendEvent({
                    name: 'isfenlei-isbrand',
                    extra: {
                        isfenlei: vm.isfenlei,
                        isbrand: vm.isbrand
                    }
                });
            }
        }
    });

    apiready = function() {

        $api.setStorage("headerheight",$api.dom("header").offsetHeight);
        var headerlist = $api.domAll('header');
        for(var i=0;i<headerlist.length;i++){
            $api.fixIos7Bar(headerlist[i]);//修复ios系统bar
        }
        if(api.systemType == 'android'){
             api.setStatusBarStyle({
                style: 'light'
             });
         }
        vm.init();//页面初始化
        var NVTabBar = api.require('NVTabBar');
        NVTabBar.open({
            styles: {
                bg: '#fff',
                h: 50,
                dividingLine: {
                    width: 0.5,
                    color: '#dddddd'
                }
            },
            items: [
                {
                    w: api.winWidth / 5.0,
                    bg: {
                        marginB: -5,
                        image: 'rgba(0,0,0,0)'
                    },
                    iconRect: {
                        w: 18.0,
                        h: 18.0,
                    },
                    icon: {
                        normal: 'widget://res/nvtabbar/ico-home.png',
                        highlight: 'widget://res/nvtabbar/ico-home-active.png',
                        selected: 'widget://res/nvtabbar/ico-home-active.png'
                    },
                    title: {
                        text: '首页',
                        size: 12.0,
                        normal: '#666666',
                        selected: '#f39905',
                        marginB: 6.0
                    }
                },
                {
                    w: api.winWidth / 5.0,
                    bg: {
                        marginB: -5,
                        image: 'rgba(0,0,0,0)'
                    },
                    iconRect: {
                        w: 18.0,
                        h: 18.0,
                    },
                    icon: {
                        normal: 'widget://res/nvtabbar/ico-fl.png',
                        highlight: 'widget://res/nvtabbar/ico-fl-active.png',
                        selected: 'widget://res/nvtabbar/ico-fl-active.png'
                    },
                    title: {
                        text: '分类',
                        size: 12.0,
                        normal: '#666666',
                        selected: '#f39905',
                        marginB: 6.0
                    }
                },
                {
                    w: api.winWidth / 5.0,
                    bg: {
                        marginB: 25,
                        image: 'rgba(0,0,0,0)'
                    },
                    iconRect: {
                        w: 52.0,
                        h: 52.0,
                    },
                    icon: {
                        normal: 'widget://res/nvtabbar/ico-cart.png',
                        highlight: 'widget://res/nvtabbar/ico-cart-active.png',
                        selected: 'widget://res/nvtabbar/ico-cart-active.png'
                    },
                    title: {
                        text: '购物车',
                        size: 12.0,
                        normal: '#666666',
                        selected: '#f39905',
                        marginB: 6.0
                    }
                },
                {
                    w: api.winWidth / 5.0,
                    bg: {
                        marginB: -5,
                        image: 'rgba(0,0,0,0)'
                    },
                    iconRect: {
                        w: 18.0,
                        h: 18.0,
                    },
                    icon: {
                        normal: 'widget://res/nvtabbar/ico-bm.png',
                        highlight: 'widget://res/nvtabbar/ico-bm-active.png',
                        selected: 'widget://res/nvtabbar/ico-bm-active.png'
                    },
                    title: {
                        text: '便民',
                        size: 12.0,
                        normal: '#666666',
                        selected: '#f39905',
                        marginB: 6.0
                    }
                },
                {
                    w: api.winWidth / 5.0,
                    bg: {
                        marginB: -5,
                        image: 'rgba(0,0,0,0)'
                    },
                    iconRect: {
                        w: 18.0,
                        h: 18.0,
                    },
                    icon: {
                        normal: 'widget://res/nvtabbar/ico-wd.png',
                        highlight: 'widget://res/nvtabbar/ico-wd-active.png',
                        selected: 'widget://res/nvtabbar/ico-wd-active.png'
                    },
                    title: {
                        text: '我的',
                        size: 12.0,
                        normal: '#666666',
                        selected: '#f39905',
                        marginB: 6.0
                    }
                }
            ],
            selectedIndex: 0
        }, function(ret, err) {
            if (ret) {
                console.log(JSON.stringify(ret));
                if(ret.eventType == 'click'){
                    if(vm.on_index == ret.index){
                        return false;
                    }else{
                        vm.on_index = ret.index;
                        api.setFrameGroupIndex({
                            name: 'IndexGroup',
                            index: vm.on_index
                        });
                    }
                }

            }
        });
        api.addEventListener({
            name: 'set_show_index'
        }, function (ret, err) {
            NVTabBar.setSelect({
                index: 0,
                selected: true
            });
            vm.on_index = 0;
            api.setFrameGroupIndex({
                name: 'IndexGroup',
                index: vm.on_index
            });
        });
        api.addEventListener({
            name: 'set_show_shop'
        }, function (ret, err) {
            NVTabBar.setSelect({
                index: 1,
                selected: true
            });
            vm.on_index = 1;
            api.setFrameGroupIndex({
                name: 'IndexGroup',
                index: vm.on_index
            });
        });
        api.addEventListener({
            name: 'set_show_cart'
        }, function (ret, err) {
            NVTabBar.setSelect({
                index: 2,
                selected: true
            });
            vm.on_index = 2;
            api.setFrameGroupIndex({
                name: 'IndexGroup',
                index: vm.on_index
            });
        });
        api.addEventListener({
            name: 'set_show_bianmin'
        }, function (ret, err) {
            NVTabBar.setSelect({
                index: 3,
                selected: true
            });
            vm.on_index = 3;
            api.setFrameGroupIndex({
                name: 'IndexGroup',
                index: vm.on_index
            });
        });
    };
</script>
